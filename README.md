# WeChat Bill Analyzer (微信支付账单分析器)

一个功能强大的微信支付账单分析工具，支持自动解析 PDF 账单、生成可视化报表，并提供深度财务洞察。

## ✨ 核心功能

### 📊 数据处理
- **自动化解压**：支持解密微信支付导出的加密 ZIP 压缩包
- **智能解析**：自动识别 PDF 表格结构，提取交易明细
- **批量处理**：一次性处理多个年份的账单文件
- **多账单合并**：支持不同密码的 ZIP 文件，自动生成跨年度汇总报表

### 📈 可视化分析
- **财务概览看板**：总支出、总收入、收支净额、交易笔数等核心指标一目了然
- **月度收支趋势**：直观展示收入与支出的时间变化
- **资金结构分布**：清晰区分收入、支出与其他类型款项
- **消费去向分析**：Top 10 商户支出占比，了解资金流向
- **商户支出排行**：识别高额支出对象
- **交易时间分布**：24 小时交易习惯热力图
- **连续消费分析**：发现异常消费模式

### 💾 数据导出
- **Excel 优化**：
  - 金额自动转换为数值格式，支持求和计算
  - 交易时间转换为 Excel 原生日期格式，支持排序筛选
- **HTML 报表**：交互式可视化图表，支持缩放、筛选等操作

## 🚀 快速开始

### 环境要求
- Python 3.11+
- [uv](https://github.com/astral-sh/uv) (推荐的 Python 包管理工具)

### 使用步骤

1. **准备数据**
   ```bash
   # 将微信导出的 ZIP 文件放入 input 目录
   mkdir -p input
   # 例如：微信支付交易明细证明(20250201-20260201).zip
   ```

2. **运行分析**
   ```bash
   uv run main.py
   ```

3. **输入密码**
   - 程序会提示输入解压密码
   - 密码可在微信支付公众号的导出消息中查看

4. **查看结果**
   - Excel 文件：`output/账单名称.xlsx`
   - 可视化报表：`output/账单名称.html`
   - 合并报表（多文件）：`output/merged_bill.xlsx` 和 `output/merged_bill.html`

## 📦 依赖说明

- `pdfplumber`: PDF 解析引擎
- `pandas`: 数据处理核心
- `pyzipper`: 加密 ZIP 文件处理
- `pyecharts`: 交互式可视化图表
- `xlsxwriter`: Excel 格式优化

## 🎯 适用场景

- **个人财务管理**：分析消费习惯，优化支出结构
- **家庭账单审计**：了解家人消费情况，识别异常支出
- **年度财务总结**：跨年度数据汇总，生成年度报告
- **商户分析**：识别高频消费商户，评估消费合理性

## 📝 许可证

MIT License
